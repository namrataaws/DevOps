Installation of Elastic Search

1. Download the zip file from below URL or you can check for latest version.

    https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.7.1-linux-x86_64.tar.gz

2. Unzip it and you are good to go.

3. Do some changes in config file, Steps as follows:

    vim elasticsearch.yml   // Uncomment below parameters
    network.host: 0.0.0.0
    http.port: 9392
    // And add below parameters
    xpack.security.enabled: true
    discovery.type: single-node

4. Run below command on instance
    sysctl -w vm.max_map_count=262144

5. You can run elasticsearch nohop or using pid

    nohup ./elasticsearch &     // 
    ./bin/elasticsearch -d -p pid

6. For system user creation use below commands

    ./elasticsearch-setup-passwords interactive/auto



Installation of Kibana

1. You can find all steps in Kibana installation document from below link.
    https://www.elastic.co/guide/en/kibana/current/deb.html 

2. Change some config in kibana config file.
    sudo vim /etc/kibana/kibana.yml     // Uncomment or below parameters

    server.port: 5114
    server.host: 10.0.1.36
    server.publicBaseUrl: "https://kibana.pfsit.xyz:5114"
    elasticsearch.hosts: ["http://localhost:9392"]
    elasticsearch.username: "kibana_system"
    elasticsearch.password: "hm82EivOJ88F5lvyajmT"      //use passwords created in elasticsearch step 6

3. Start kibana service using systemd
    sudo systemctl start kibana




Installation of nginx and config

1. Download and install Nginx in instance
    sudo apt-get install nginx

2. Config nginx confign file as below

server {
        listen 80;
        server_name  pfsit.xyz *.pfsit.xyz;
        return 301 https://kibana.pfsit.xyz;
         if ( $host != "kibana.pfsit.xyz" ){
        return 444; #CONNECTION CLOSED WITHOUT RESPONSE
    }
}
server{
        listen 443 ssl;
        server_name  pfsit.xyz *.pfsit.xyz;
        if ( $host != "kibana.pfsit.xyz" ){
        return 444; #CONNECTION CLOSED WITHOUT RESPONSE
        }
        #auth_basic "Restricted Access";
        #auth_basic_user_file /etc/nginx/htpasswd.users;
        ssl_certificate         /etc/letsencrypt/live/pfsit.xyz/fullchain.pem;
        ssl_certificate_key     /etc/letsencrypt/live/pfsit.xyz/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/pfsit.xyz/fullchain.pem;

        location / {
                proxy_pass http://localhost:5114;
                proxy_http_version 1.1;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection 'upgrade';
                proxy_set_header Host $host;
                proxy_cache_bypass $http_upgrade;

    }
}

3. Restart nginx 
    sudo systemctl restart nginx


***************************END********************************************